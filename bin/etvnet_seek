#!/usr/bin/env ruby
# encoding: utf-8

require 'rubygems' unless RUBY_VERSION =~ /1.9.*/

$:.unshift(File::join(File::dirname(File::dirname(__FILE__)), "lib"))

$KCODE='u'

require 'main'

client = Main.new

keywords = ARGV.join(' ')

if RUBY_PLATFORM =~ /mswin32/
  keywords = Runglish.new.lat_to_ru(keywords)
end

movie_link = client.search_and_grab_link keywords

if movie_link
  puts "Link: #{movie_link}"
  
  if RUBY_PLATFORM =~ /(win|w)32$/
    `start wmplayer #{movie_link}`
  elsif RUBY_PLATFORM =~ /darwin/
    `open #{movie_link}`
  end

end

